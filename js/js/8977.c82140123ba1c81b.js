"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8977],{75158:function(e,r,t){t.d(r,{Z:function(){return k}});var n=t(63366),o=t(87462),a=t(67294),s=t(86010),i=t(94780),c=t(41796),u=t(37743),l=t(54235),d=t(85893),p=(0,l.Z)((0,d.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),m=(0,l.Z)((0,d.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),h=(0,l.Z)((0,d.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox"),f=t(36622),v=t(78884),x=t(81719),y=t(34867);function g(e){return(0,y.Z)("MuiCheckbox",e)}var b=(0,t(1588).Z)("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary"]);const A=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],w=(0,x.ZP)(u.Z,{shouldForwardProp:e=>(0,x.FO)(e)||"classes"===e,name:"MuiCheckbox",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,t.indeterminate&&r.indeterminate,"default"!==t.color&&r[`color${(0,f.Z)(t.color)}`]]}})((({theme:e,ownerState:r})=>(0,o.Z)({color:(e.vars||e).palette.text.secondary},!r.disableRipple&&{"&:hover":{backgroundColor:e.vars?`rgba(${"default"===r.color?e.vars.palette.action.activeChannel:e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.hoverOpacity})`:(0,c.Fq)("default"===r.color?e.palette.action.active:e.palette[r.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"default"!==r.color&&{[`&.${b.checked}, &.${b.indeterminate}`]:{color:(e.vars||e).palette[r.color].main},[`&.${b.disabled}`]:{color:(e.vars||e).palette.action.disabled}}))),T=(0,d.jsx)(m,{}),S=(0,d.jsx)(p,{}),O=(0,d.jsx)(h,{});var k=a.forwardRef((function(e,r){var t,c;const u=(0,v.Z)({props:e,name:"MuiCheckbox"}),{checkedIcon:l=T,color:p="primary",icon:m=S,indeterminate:h=!1,indeterminateIcon:x=O,inputProps:y,size:b="medium",className:k}=u,j=(0,n.Z)(u,A),C=h?x:m,I=h?x:l,E=(0,o.Z)({},u,{color:p,indeterminate:h,size:b}),R=(e=>{const{classes:r,indeterminate:t,color:n}=e,a={root:["root",t&&"indeterminate",`color${(0,f.Z)(n)}`]},s=(0,i.Z)(a,g,r);return(0,o.Z)({},r,s)})(E);return(0,d.jsx)(w,(0,o.Z)({type:"checkbox",inputProps:(0,o.Z)({"data-indeterminate":h},y),icon:a.cloneElement(C,{fontSize:null!=(t=C.props.fontSize)?t:b}),checkedIcon:a.cloneElement(I,{fontSize:null!=(c=I.props.fontSize)?c:b}),ownerState:E,ref:r,className:(0,s.default)(R.root,k)},j,{classes:R}))}))},34637:function(e,r,t){t.d(r,{Y:function(){return d},Z:function(){return p}});var n=t(59499),o=t(81719),a=t(87054),s=(t(67294),t(85893));function i(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function c(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?i(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var u=(0,o.ZP)(a.Z)((function(e){var r=e.theme;return{border:"0px",flex:1,backgroundColor:"#383D51",borderRadius:"4px","&.Mui-selected, &.Mui-selected:hover":{backgroundColor:"#FFFFFF",borderRadius:"4px !important"},"&.Mui-selected, &.Mui-disabled":{zIndex:100,height:"100%",display:"flex",justifyContent:"center",".MuiTypography-subheader1":{background:r.palette.gradients.aaveGradient,backgroundClip:"text",textFillColor:"transparent"},".MuiTypography-secondary14":{background:r.palette.gradients.aaveGradient,backgroundClip:"text",textFillColor:"transparent"}}}})),l=(0,o.ZP)(a.Z)((function(e){var r=e.theme;return{border:"0px",flex:1,color:r.palette.text.muted,borderRadius:"4px","&.Mui-selected, &.Mui-selected:hover":{border:"1px solid ".concat(r.palette.other.standardInputLine),backgroundColor:"#FFFFFF",borderRadius:"4px !important"},"&.Mui-selected, &.Mui-disabled":{zIndex:100,height:"100%",display:"flex",justifyContent:"center",color:r.palette.background.header}}}));function d(e){return(0,s.jsx)(l,c({},e))}function p(e){return(0,s.jsx)(u,c({},e))}},59379:function(e,r,t){t.d(r,{f:function(){return d},Z:function(){return p}});var n=t(59499),o=t(81719),a=t(85390),s=t(85893);function i(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function c(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?i(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var u=(0,o.ZP)(a.Z)({backgroundColor:"#383D51",border:"1px solid rgba(235, 235, 237, 0.12)",padding:"4px"}),l=(0,o.ZP)(a.Z)((function(e){return{backgroundColor:e.theme.palette.background.header,padding:"2px",height:"36px",width:"100%"}}));function d(e){return(0,s.jsx)(l,c({},e))}function p(e){return(0,s.jsx)(u,c({},e))}},96046:function(e,r,t){t.r(r),t.d(r,{WithdrawModal:function(){return De}});var n=t(59499),o=t(49501),a=t(23286),s=t(67294),i=t(47130),c=t(73965),u=t(8195),l=t(46930),d=t(69125),p=t(63206),m=t(31959),h=t(94635),f=t(90116),v=t(1279);var x=s.forwardRef((function(e,r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r},e),s.createElement("path",{fillRule:"evenodd",d:"M16.707 10.293a1 1 0 010 1.414l-6 6a1 1 0 01-1.414 0l-6-6a1 1 0 111.414-1.414L9 14.586V3a1 1 0 012 0v11.586l4.293-4.293a1 1 0 011.414 0z",clipRule:"evenodd"}))})),y=t(30120),g=t(81645),b=t(29630),A=t(9144),w=t(75158),T=t(25935),S=t(41024),O=t(72667),k=t(69331),j=t(74119),C=t(30313),I=t(39051),E=t(71691),R=t(77537),W=t(20301),D=t(50597),P=t(68448),_=t(57609),M=t(87385),H=t(53601),N=t(67916),L=t(57824),Z=t(94671),B=t(70794),U=function(e,r,t){var n=(0,v.hE)((null===r||void 0===r?void 0:r.underlyingBalance)||"0"),o=(0,v.hE)(t.unborrowedLiquidity),a=B.Z.min(n,o),s=(0,v.hE)("0"),i=e.isInEmode&&e.userEmodeCategoryId===t.eModeCategoryId?t.formattedEModeLiquidationThreshold:t.formattedReserveLiquidationThreshold;if(null!==r&&void 0!==r&&r.usageAsCollateralEnabledOnUser&&"0"!==t.reserveLiquidationThreshold&&"0"!==e.totalBorrowsMarketReferenceCurrency){var c=(0,v.hE)(e.healthFactor).minus("1.01");c.gt("0")&&(s=c.multipliedBy(e.totalBorrowsMarketReferenceCurrency).div(i)),a=B.Z.min(a,s.dividedBy(t.formattedPriceInMarketReferenceCurrency))}return a},q=t(50029),F=t(17674),Y=t(87794),z=t.n(Y),G=t(75331),V=t(24243),Q=t(80854),K=t(85945),$=t(56371),X=t(89291),J=t(32113),ee=t(39771),re=t(31001),te=t(67489),ne=t(85893);function oe(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function ae(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?oe(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):oe(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var se=function(e){var r=e.amountToSwap,t=e.amountToReceive,n=e.isWrongNetwork,a=e.sx,i=e.poolReserve,c=e.targetReserve,l=e.isMaxSelected,d=e.loading,p=e.blocked,m=e.buildTxFn,h=(0,D.Y)((function(e){return[e.withdrawAndSwitch,e.currentMarketData,e.jsonRpcProvider,e.account,e.generateApproval,e.estimateGasLimit,e.walletApprovalMethodPreference,e.generateSignatureRequest,e.addTransaction,e.trackEvent]})),f=(0,F.Z)(h,10),v=f[0],x=f[1],y=f[2],g=f[3],b=f[4],A=f[5],w=f[6],T=f[7],S=f[8],O=f[9],k=(0,u.vR)(),C=k.approvalTxState,I=k.mainTxState,E=k.loadingTxns,W=k.setMainTxState,P=k.setTxError,M=k.setGasLimit,H=k.setLoadingTxns,N=k.setApprovalTxState,L=(0,R.Z)(),B=L.sendTx,U=L.signTxData,Y=(0,K.NL)(),oe=(0,s.useState)(void 0),se=oe[0],ie=oe[1],ce=(0,s.useState)(),ue=ce[0],le=ce[1],de=(0,s.useMemo)((function(){return void 0!==se&&-1!==se&&"0"!==r&&!n&&se<=Number(r)}),[se,r,n]),pe=w===J.n.PERMIT,me=function(){var e=(0,q.Z)(z().mark((function e(){var n,o,a,s,u;return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,W(ae(ae({},I),{},{loading:!0})),e.next=4,m();case 4:return n=e.sent,o=v({poolReserve:i,targetReserve:c,isMaxSelected:l,amountToSwap:(0,$.parseUnits)(r,i.decimals).toString(),amountToReceive:(0,$.parseUnits)(t,c.decimals).toString(),augustus:n.augustus,txCalldata:n.swapCallData,signatureParams:ue}),e.next=8,A(o);case 8:return a=e.sent,e.next=11,B(a);case 11:return s=e.sent,e.next=14,s.wait(1);case 14:Y.invalidateQueries({queryKey:re.B.pool}),Y.invalidateQueries({queryKey:re.B.gho}),W({txHash:s.hash,loading:!1,success:!0}),S(s.hash,{action:G.UQ.withdrawAndSwitch,txState:"success",asset:i.underlyingAsset,amount:(0,$.parseUnits)(n.inputAmount,i.decimals).toString(),assetName:i.name,outAsset:c.underlyingAsset,outAssetName:c.name,outAmount:(0,$.parseUnits)(n.outputAmount,c.decimals).toString()}),e.next=26;break;case 20:e.prev=20,e.t0=e.catch(0),u=(0,ee.WG)(e.t0,ee.aD.GAS_ESTIMATION,!1),P(u),W({txHash:void 0,loading:!1}),O(_.vh.TRANSACTION_ERROR,{transactiontype:G.UQ.withdrawAndSwitch,asset:i.underlyingAsset,assetName:i.name,error:e.t0});case 26:case"end":return e.stop()}}),e,null,[[0,20]])})));return function(){return e.apply(this,arguments)}}(),he=function(){var e=(0,q.Z)(z().mark((function e(){var t,n,o,a,s,c,u,l,d;return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(0,j.sm)(r,i.decimals),n={user:g,token:i.aTokenAddress,spender:x.addresses.WITHDRAW_SWITCH_ADAPTER||"",amount:t},e.prev=2,!pe){e.next=16;break}return o=Math.floor(Date.now()/1e3+3600).toString(),e.next=7,T(ae(ae({},n),{},{deadline:o}));case 7:return a=e.sent,N(ae(ae({},C),{},{loading:!0})),e.next=11,U(a);case 11:s=e.sent,le({signature:s,deadline:o,amount:t}),N({txHash:X.Z,loading:!1,success:!0}),e.next=30;break;case 16:return c=b(n),e.next=19,A(c);case 19:return u=e.sent,N(ae(ae({},C),{},{loading:!0})),e.next=23,B(u);case 23:return l=e.sent,e.next=26,l.wait(1);case 26:N({txHash:l.hash,loading:!1,success:!0}),S(l.hash,{action:G.UQ.withdrawAndSwitch,txState:"success",asset:i.aTokenAddress,amount:(0,$.parseUnits)(t,i.decimals).toString(),assetName:"a".concat(i.symbol),spender:x.addresses.WITHDRAW_SWITCH_ADAPTER}),P(void 0),fe(i.aTokenAddress);case 30:e.next=37;break;case 32:e.prev=32,e.t0=e.catch(2),d=(0,ee.WG)(e.t0,ee.aD.GAS_ESTIMATION,!1),P(d),C.success||N({txHash:void 0,loading:!1});case 37:case"end":return e.stop()}}),e,null,[[2,32]])})));return function(){return e.apply(this,arguments)}}(),fe=(0,s.useCallback)(function(){var e=(0,q.Z)(z().mark((function e(r){var t,n,o;return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return H(!0),t=y(),n=new V.A(t),e.next=5,n.approvedAmount({user:g,token:r,spender:x.addresses.WITHDRAW_SWITCH_ADAPTER||""});case 5:o=e.sent,ie(o),H(!1);case 8:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),[y,g,x.addresses.WITHDRAW_SWITCH_ADAPTER,H]);return(0,s.useEffect)((function(){fe(i.aTokenAddress)}),[fe,i.aTokenAddress]),(0,s.useEffect)((function(){var e=0;e=Number(Q.eB[G.UQ.withdrawAndSwitch].recommended),de&&!C.success&&(e+=Number(Z.pQ)),M(e.toString())}),[de,C,M]),(0,ne.jsx)(te.B,{mainTxState:I,approvalTxState:C,isWrongNetwork:n,preparingTransactions:E,handleAction:me,requiresAmount:!0,amount:r,handleApproval:function(){return he()},requiresApproval:de,actionText:(0,ne.jsx)(o.cC,{id:"Withdraw and Switch"}),actionInProgressText:(0,ne.jsx)(o.cC,{id:"Withdrawing and Switching"}),sx:a,errorParams:{loading:!1,disabled:p||!(null!==C&&void 0!==C&&C.success),content:(0,ne.jsx)(o.cC,{id:"Withdraw and Switch"}),handleClick:me},fetchingData:d,blocked:p,tryPermit:!0})},ie=t(71335),ce=t(55200),ue=function(e){var r=e.txHash,t=e.amount,n=e.symbol,a=e.outAmount,s=e.outSymbol;return(0,ne.jsx)(ce.R,{txHash:r,children:(0,ne.jsxs)(y.Z,{sx:{mt:2,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center"},children:[(0,ne.jsx)(b.Z,{children:(0,ne.jsx)(o.cC,{id:"You've successfully withdrew & switched tokens."})}),(0,ne.jsxs)(y.Z,{sx:{display:"flex",alignItems:"center",gap:2,mt:3},children:[(0,ne.jsx)(O.T1,{sx:{fontSize:"20px"},symbol:n}),(0,ne.jsx)(S.B,{value:Number(t),compact:!0,variant:"main14"}),(0,ne.jsx)(b.Z,{variant:"secondary14",children:n}),(0,ne.jsx)(g.Z,{sx:{fontSize:"14px"},children:(0,ne.jsx)(ie.Z,{fontSize:"14px"})}),(0,ne.jsx)(O.T1,{sx:{fontSize:"20px"},symbol:s}),(0,ne.jsx)(S.B,{value:Number(a),variant:"main14"}),(0,ne.jsx)(b.Z,{variant:"secondary14",children:s})]})]})})},le=t(21046),de=t(28744),pe=t(93591),me=t(98386);function he(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function fe(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?he(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):he(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var ve,xe=function(e){var r=e.poolReserve,t=e.amountToWithdraw,n=e.isWrongNetwork,a=e.tokenWrapperAddress,i=e.sx,c=e.blocked,l=(0,D.Y)((function(e){return[e.account,e.estimateGasLimit,e.walletApprovalMethodPreference,e.account,e.currentMarketData]})),d=(0,F.Z)(l,5),p=d[0],m=d[1],h=d[2],f=d[3],v=d[4],x=(0,R.Z)().sendTx,y=(0,K.NL)(),g=(0,s.useState)(),b=g[0],A=g[1],w=(0,u.vR)(),T=w.approvalTxState,S=w.mainTxState,O=w.loadingTxns,k=w.setLoadingTxns,j=w.setApprovalTxState,C=w.setMainTxState,I=w.setGasLimit,E=w.setTxError,W=(0,me.z)().tokenWrapperService,P=(0,pe.i)({marketData:v,token:r.aTokenAddress,spender:a}),_=P.data,M=P.isFetching,H=P.refetch;k(M);var N=!1;void 0!==_&&(N=(0,Z.iv)({approvedAmount:_.toString(),amount:t,signedAmount:b?b.amount:"0"}));var L=h===J.n.PERMIT,B=(0,de.M)({usePermit:L,approvedAmount:{amount:(null===_||void 0===_?void 0:_.toString())||"0",spender:a,token:r.aTokenAddress,user:f},requiresApproval:N,assetAddress:r.aTokenAddress,symbol:r.symbol,decimals:r.decimals,signatureAmount:t,onApprovalTxConfirmed:H,onSignTxCompleted:function(e){return A(e)}}).approval,U=function(){var e=(0,q.Z)(z().mark((function e(){var n,o,s,i,c;return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,C(fe(fe({},S),{},{loading:!0})),o="-1"===t?le.Bz.toString():(0,Q.gU)(t,r.decimals),!L||!b){e.next=17;break}return e.next=6,W.withdrawWrappedTokenWithPermit(o,a,f,b.deadline,b.signature);case 6:return s=e.sent,e.next=9,m(s);case 9:return s=e.sent,e.next=12,x(s);case 12:return n=e.sent,e.next=15,n.wait(1);case 15:e.next=28;break;case 17:return e.next=19,W.withdrawWrappedToken(o,a,p);case 19:return i=e.sent,e.next=22,m(i);case 22:return i=e.sent,e.next=25,x(i);case 25:return n=e.sent,e.next=28,n.wait(1);case 28:C({txHash:n.hash,loading:!1,success:!0}),y.invalidateQueries({queryKey:re.B.pool}),y.invalidateQueries({queryKey:re.B.approvedAmount(f,r.aTokenAddress,a,v)}),e.next=38;break;case 33:e.prev=33,e.t0=e.catch(0),c=(0,ee.WG)(e.t0,ee.aD.GAS_ESTIMATION,!1),E(c),j({txHash:void 0,loading:!1});case 38:case"end":return e.stop()}}),e,null,[[0,33]])})));return function(){return e.apply(this,arguments)}}();return(0,s.useEffect)((function(){var e=0;e=Number(Q.eB[G.UQ.withdraw].recommended),N&&!T.success&&(e+=Number(Z.pQ)),I(e.toString())}),[N,T,L,I]),(0,ne.jsx)(te.B,{blocked:c,preparingTransactions:O,approvalTxState:T,mainTxState:S,amount:t,isWrongNetwork:n,requiresAmount:!0,actionInProgressText:(0,ne.jsx)(o.cC,{id:"Withdrawing"}),actionText:(0,ne.jsx)(o.cC,{id:"Withdraw"}),handleAction:U,requiresApproval:N,handleApproval:B,sx:i,tryPermit:!0})};!function(e){e[e.CAN_NOT_WITHDRAW_THIS_AMOUNT=0]="CAN_NOT_WITHDRAW_THIS_AMOUNT",e[e.POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY=1]="POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY",e[e.ZERO_LTV_WITHDRAW_BLOCKED=2]="ZERO_LTV_WITHDRAW_BLOCKED"}(ve||(ve={}));var ye,ge=function(e){var r,t=e.assetsBlockingWithdraw,a=e.poolReserve,s=e.healthFactorAfterWithdraw,i=e.withdrawAmount,c=e.user,l=(0,u.vR)().mainTxState,d=void 0,p=(0,v.hE)(a.unborrowedLiquidity);l.success||l.txHash||(t.length>0&&!t.includes(a.symbol)?d=ve.ZERO_LTV_WITHDRAW_BLOCKED:s.lt("1")&&"0"!==c.totalBorrowsMarketReferenceCurrency?d=ve.CAN_NOT_WITHDRAW_THIS_AMOUNT:d||!p.eq("0")&&!(0,v.hE)(i).gt(a.unborrowedLiquidity)||(d=ve.POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY));var m=(r={},(0,n.Z)(r,ve.CAN_NOT_WITHDRAW_THIS_AMOUNT,(0,ne.jsx)(o.cC,{id:"You can not withdraw this amount because it will cause collateral call"})),(0,n.Z)(r,ve.POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY,(0,ne.jsx)(o.cC,{id:"These funds have been borrowed and are not available for withdrawal at this time."})),(0,n.Z)(r,ve.ZERO_LTV_WITHDRAW_BLOCKED,(0,ne.jsx)(o.cC,{id:"Assets with zero LTV ({assetsBlockingWithdraw}) must be withdrawn or disabled as collateral to perform this action",values:{assetsBlockingWithdraw:t}})),r);return{blockingError:d,errorComponent:d?m[d]:null}};function be(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function Ae(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?be(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):be(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}!function(e){e[e.CAN_NOT_WITHDRAW_THIS_AMOUNT=0]="CAN_NOT_WITHDRAW_THIS_AMOUNT",e[e.POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY=1]="POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY",e[e.ZERO_LTV_WITHDRAW_BLOCKED=2]="ZERO_LTV_WITHDRAW_BLOCKED"}(ye||(ye={}));var we,Te=function(e){var r=e.poolReserve,t=e.userReserve,n=e.symbol,a=e.isWrongNetwork,i=e.user,d=(0,u.vR)(),p=d.gasLimit,m=d.mainTxState,h=d.txError,B=(0,R.Z)().currentAccount,q=(0,c.HT)().reserves,F=(0,l.f)(),Y=F.currentNetworkConfig,z=F.currentChainId,G=(0,E.P)(),V=(0,s.useState)(""),Q=V[0],K=V[1],$=(0,s.useState)(!1),X=$[0],J=$[1],ee=(0,s.useRef)(""),re=(0,D.Y)((function(e){return e.trackEvent})),te=(0,s.useState)("0.1"),oe=te[0],ae=te[1],ie=q.filter((function(e){return e.underlyingAsset!==r.underlyingAsset})).map((function(e){return{address:e.underlyingAsset,symbol:e.symbol,iconSymbol:e.iconSymbol}}));ie=[].concat((0,f.Z)(ie.filter((function(e){return"GHO"===e.symbol}))),(0,f.Z)(ie.filter((function(e){return"GHO"!==e.symbol}))));var ce=(0,s.useState)(ie[0]),le=ce[0],de=ce[1],pe="-1"===Q,me=i.userReservesData.find((function(e){return e.underlyingAsset===le.address})),he=U(i,t,r),fe=(0,v.hE)((null===t||void 0===t?void 0:t.underlyingBalance)||"0"),ve=!1,ye=G.find((function(e){return e.tokenOut.underlyingAsset===r.underlyingAsset}));ye&&(ve=le.address===ye.tokenIn.underlyingAsset);var be=(0,I.E)(ee.current,r.decimals,(null===ye||void 0===ye?void 0:ye.tokenWrapperAddress)||""),we=be.data,Te=be.isFetching,Se=(0,C.k)({chainId:Y.underlyingChainId||z,userAddress:B,swapIn:Ae(Ae({},r),{},{amount:ee.current}),swapOut:Ae(Ae({},me.reserve),{},{amount:"0"}),max:pe&&he.eq(fe),skip:ve||m.loading||!1,maxSlippage:Number(oe)}),Oe=Se.inputAmountUSD,ke=Se.inputAmount,je=Se.outputAmount,Ce=Se.outputAmountUSD,Ie=Se.error,Ee=Se.loading,Re=Se.buildTxFn,We=Ce;ve&&(We=(0,v.hE)(we||"0").multipliedBy((null===ye||void 0===ye?void 0:ye.tokenIn.priceInUSD)||0).toString());var De=Ee&&"0"===Ce||ve&&Te,Pe=(0,v.hE)(r.unborrowedLiquidity),_e=(0,Z.Vc)(i),Me=pe?he.toString(10):Q,He=(0,P.DX)({user:i,userReserve:t,poolReserve:r,withdrawAmount:Me}),Ne=ge({assetsBlockingWithdraw:_e,poolReserve:r,healthFactorAfterWithdraw:He,withdrawAmount:Me,user:i}),Le=Ne.blockingError,Ze=Ne.errorComponent,Be=He.toNumber()>=1&&He.toNumber()<1.5&&t.usageAsCollateralEnabledOnUser,Ue=(0,v.hE)(Me).multipliedBy((null===t||void 0===t?void 0:t.reserve.priceInUSD)||0),qe=(0,j.IG)(je,oe,me.reserve.decimals);if(m.success){var Fe=ke,Ye=qe;return ve&&(Fe=ee.current,Ye=we||"0"),(0,ne.jsx)(ue,{txHash:m.txHash,amount:Fe,symbol:r.isWrappedBaseAsset?Y.baseAssetSymbol:r.symbol,outSymbol:le.symbol,outAmount:Ye})}return(0,ne.jsxs)(ne.Fragment,{children:[(0,ne.jsx)(H.W,{inputTitle:(0,ne.jsx)(o.cC,{id:"Withdraw"}),value:Me,onChange:function(e){var t="-1"===e,n=(0,M.$w)(e,r.decimals);ee.current=t?he.toString(10):n,K(n),t&&he.eq(fe)&&re(_.vh.MAX_INPUT_SELECTION,{type:"withdraw"})},symbol:n,assets:[{balance:he.toString(10),symbol:n,iconSymbol:r.isWrappedBaseAsset?Y.baseAssetSymbol:r.iconSymbol}],usdValue:Ue.toString(10),isMaxSelected:pe,disabled:m.loading,maxValue:he.toString(10),balanceText:Pe.lt(fe)?(0,ne.jsx)(o.cC,{id:"Available"}):(0,ne.jsx)(o.cC,{id:"Supply balance"})}),(0,ne.jsxs)(y.Z,{sx:{padding:"18px",pt:"14px",display:"flex",justifyContent:"space-between"},children:[(0,ne.jsx)(g.Z,{sx:{fontSize:"18px !important"},children:(0,ne.jsx)(x,{})}),(0,ne.jsx)(T.B,{loading:De,outputAmountUSD:Ce,inputAmountUSD:Oe})]}),(0,ne.jsx)(H.W,{value:ve?we||"":je,onSelect:de,usdValue:We,symbol:le.symbol,assets:ie,inputTitle:(0,ne.jsx)(o.cC,{id:"Receive (est.)"}),balanceText:(0,ne.jsx)(o.cC,{id:"Supply balance"}),disableInput:!0,loading:De}),Ie&&!De&&!ve&&(0,ne.jsx)(b.Z,{variant:"helperText",color:"error.main",children:Ie}),void 0!==Le&&(0,ne.jsx)(b.Z,{variant:"helperText",color:"error.main",children:Ze}),(0,ne.jsxs)(L.m6,{gasLimit:p,slippageSelector:ve?null:(0,ne.jsx)(W.n,{selectedSlippage:oe,setSlippage:ae,slippageTooltipHeader:(0,ne.jsxs)(A.Z,{direction:"row",gap:2,alignItems:"center",justifyContent:"space-between",children:[(0,ne.jsx)(o.cC,{id:"Minimum amount received"}),(0,ne.jsx)(A.Z,{alignItems:"end",children:(0,ne.jsxs)(A.Z,{direction:"row",children:[(0,ne.jsx)(O.T1,{symbol:me.reserve.iconSymbol,sx:{mr:1,fontSize:"14px"}}),(0,ne.jsx)(S.B,{value:qe,variant:"secondary12"})]})})]})}),children:[(0,ne.jsx)(L.oD,{description:(0,ne.jsx)(o.cC,{id:"Remaining supply"}),value:fe.minus(Me||"0").toString(10),symbol:r.isWrappedBaseAsset?Y.baseAssetSymbol:r.symbol}),(0,ne.jsx)(L.jz,{visibleHfChange:!!Q,healthFactor:i?i.healthFactor:"-1",futureHealthFactor:He.toString(10)})]}),h&&(0,ne.jsx)(N.Q,{txError:h}),Be&&(0,ne.jsxs)(ne.Fragment,{children:[(0,ne.jsx)(k.v,{severity:"error",sx:{my:6},children:(0,ne.jsx)(o.cC,{id:"Withdrawing this amount will reduce your health factor and increase risk of liquidation."})}),(0,ne.jsxs)(y.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",mx:"24px",mb:"12px"},children:[(0,ne.jsx)(w.Z,{checked:X,onChange:function(){J(!X),re(_.vh.ACCEPT_RISK,{modal:"Withdraw",riskCheckboxAccepted:X})},size:"small","data-cy":"risk-checkbox"}),(0,ne.jsx)(b.Z,{variant:"description",children:(0,ne.jsx)(o.cC,{id:"I acknowledge the risks involved."})})]})]}),ve?(0,ne.jsx)(xe,{poolReserve:r,amountToWithdraw:ee.current,isWrongNetwork:a,tokenWrapperAddress:(null===ye||void 0===ye?void 0:ye.tokenWrapperAddress)||"",sx:Be?{mt:0}:{},blocked:void 0!==Le||Be&&!X}):(0,ne.jsx)(se,{poolReserve:r,targetReserve:me.reserve,amountToSwap:ke,amountToReceive:qe,isMaxSelected:pe&&he.eq(fe),isWrongNetwork:a,blocked:void 0!==Le||Be&&!X,buildTxFn:Re,sx:Be?{mt:0}:{}})]})},Se=t(93608),Oe=function(e){var r=e.poolReserve,t=e.amountToWithdraw,n=e.poolAddress,a=e.isWrongNetwork,s=e.symbol,i=e.blocked,c=e.sx,u=(0,D.Y)((function(e){return e.withdraw})),l=(0,X.Q)({tryPermit:!1,handleGetTxns:function(){var e=(0,q.Z)(z().mark((function e(){return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u({reserve:n,amount:t,aTokenAddress:r.aTokenAddress}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),skip:!t||0===parseFloat(t)||i,deps:[t,n],eventTxInfo:{amount:t,assetName:r.name,asset:r.underlyingAsset},protocolAction:G.UQ.withdraw}),d=l.action,p=l.loadingTxns,m=l.mainTxState,h=l.approvalTxState,f=l.approval,v=l.requiresApproval;return(0,ne.jsx)(te.B,{blocked:i,preparingTransactions:p,approvalTxState:h,mainTxState:m,amount:t,isWrongNetwork:a,requiresAmount:!0,actionInProgressText:(0,ne.jsx)(o.cC,{id:"Withdrawing {symbol}",values:{symbol:s}}),actionText:(0,ne.jsx)(o.cC,{id:"Withdraw {symbol}",values:{symbol:s}}),handleAction:d,handleApproval:function(){return f([{amount:t,underlyingAsset:n}])},requiresApproval:v,sx:c})};!function(e){e[e.CAN_NOT_WITHDRAW_THIS_AMOUNT=0]="CAN_NOT_WITHDRAW_THIS_AMOUNT",e[e.POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY=1]="POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY",e[e.ZERO_LTV_WITHDRAW_BLOCKED=2]="ZERO_LTV_WITHDRAW_BLOCKED"}(we||(we={}));var ke,je=function(e){var r=e.poolReserve,t=e.userReserve,n=e.unwrap,a=e.setUnwrap,i=e.symbol,c=e.isWrongNetwork,d=e.user,p=(0,u.vR)(),m=p.gasLimit,h=p.mainTxState,f=p.txError,x=(0,l.f)().currentNetworkConfig,g=(0,s.useState)(""),A=g[0],T=g[1],S=(0,s.useState)(""),O=S[0],j=S[1],C=(0,s.useState)(!1),I=C[0],E=C[1],R=(0,s.useRef)(""),W=(0,D.Y)((function(e){return e.trackEvent})),M="-1"===A,B=U(d,t,r),q=(0,v.hE)((null===t||void 0===t?void 0:t.underlyingBalance)||"0"),F=(0,v.hE)(r.unborrowedLiquidity),Y=M?B.toString(10):A,z=(0,Z.Vc)(d),G=(0,P.DX)({user:d,userReserve:t,poolReserve:r,withdrawAmount:Y}),V=ge({assetsBlockingWithdraw:z,poolReserve:r,healthFactorAfterWithdraw:G,withdrawAmount:Y,user:d}),K=V.blockingError,$=V.errorComponent,X=G.toNumber()>=1&&G.toNumber()<1.5&&t.usageAsCollateralEnabledOnUser,J=(0,v.hE)(Y).multipliedBy((null===t||void 0===t?void 0:t.reserve.priceInUSD)||0);return h.success?(0,ne.jsx)(Se.R,{action:(0,ne.jsx)(o.cC,{id:"withdrew"}),amount:R.current,symbol:n&&r.isWrappedBaseAsset?x.baseAssetSymbol:r.symbol}):(0,ne.jsxs)(ne.Fragment,{children:[(0,ne.jsx)(H.W,{value:Y,onChange:function(e){var r="-1"===e;R.current=r?B.toString(10):e,T(e),r&&B.eq(q)?(W(_.vh.MAX_INPUT_SELECTION,{type:"withdraw"}),j("-1")):j(B.toString(10))},symbol:i,assets:[{balance:B.toString(10),symbol:i,iconSymbol:n&&r.isWrappedBaseAsset?x.baseAssetSymbol:r.iconSymbol}],usdValue:J.toString(10),isMaxSelected:M,disabled:h.loading,maxValue:B.toString(10),balanceText:F.lt(q)?(0,ne.jsx)(o.cC,{id:"Available"}):(0,ne.jsx)(o.cC,{id:"Supply balance"})}),void 0!==K&&(0,ne.jsx)(b.Z,{variant:"helperText",color:"error.main",children:$}),r.isWrappedBaseAsset&&(0,ne.jsx)(L.Pu,{unwrapped:n,setUnWrapped:a,label:(0,ne.jsx)(b.Z,{children:"Unwrap ".concat(r.symbol," (to withdraw ").concat(x.baseAssetSymbol,")")})}),(0,ne.jsxs)(L.m6,{gasLimit:m,children:[(0,ne.jsx)(L.oD,{description:(0,ne.jsx)(o.cC,{id:"Remaining supply"}),value:q.minus(Y||"0").toString(10),symbol:r.isWrappedBaseAsset?x.baseAssetSymbol:r.symbol}),(0,ne.jsx)(L.jz,{visibleHfChange:!!A,healthFactor:d?d.healthFactor:"-1",futureHealthFactor:G.toString(10)})]}),f&&(0,ne.jsx)(N.Q,{txError:f}),X&&(0,ne.jsxs)(ne.Fragment,{children:[(0,ne.jsx)(k.v,{severity:"error",sx:{my:6},children:(0,ne.jsx)(o.cC,{id:"Withdrawing this amount will reduce your health factor and increase risk of liquidation."})}),(0,ne.jsxs)(y.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",mx:"24px",mb:"12px"},children:[(0,ne.jsx)(w.Z,{checked:I,onChange:function(){E(!I),W(_.vh.ACCEPT_RISK,{modal:"Withdraw",riskCheckboxAccepted:I})},size:"small","data-cy":"risk-checkbox"}),(0,ne.jsx)(b.Z,{variant:"description",children:(0,ne.jsx)(o.cC,{id:"I acknowledge the risks involved."})})]})]}),(0,ne.jsx)(Oe,{poolReserve:r,amountToWithdraw:M?O:Y,poolAddress:n&&r.isWrappedBaseAsset?Q.hP:r.underlyingAsset,isWrongNetwork:c,symbol:i,blocked:void 0!==K||X&&!I,sx:X?{mt:0}:{}})]})},Ce=t(34637),Ie=t(59379);function Ee(e){var r,t=e.withdrawType,n=e.setWithdrawType,a=(0,l.f)().currentMarketData,s=(0,D.Y)((function(e){return e.trackEvent}));return null!==(r=a.enabledFeatures)&&void 0!==r&&r.collateralRepay?(0,ne.jsx)(y.Z,{sx:{mb:6},children:(0,ne.jsxs)(Ie.f,{color:"primary",value:t,exclusive:!0,onChange:function(e,r){return n(r)},children:[(0,ne.jsx)(Ce.Y,{value:ke.WITHDRAW,disabled:t===ke.WITHDRAW,onClick:function(){return s(_.sj.SWITCH_WITHDRAW_TYPE,{withdrawType:"Withdraw"})},children:(0,ne.jsx)(b.Z,{variant:"buttonM",children:(0,ne.jsx)(o.cC,{id:"Withdraw"})})}),(0,ne.jsx)(Ce.Y,{value:ke.WITHDRAWSWITCH,disabled:t===ke.WITHDRAWSWITCH,onClick:function(){return s(_.sj.SWITCH_WITHDRAW_TYPE,{withdrawType:"Withdraw and Switch"})},children:(0,ne.jsx)(b.Z,{variant:"buttonM",children:(0,ne.jsx)(o.cC,{id:"Withdraw & Switch"})})})]})}):null}function Re(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function We(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?Re(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Re(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}!function(e){e[e.WITHDRAW=0]="WITHDRAW",e[e.WITHDRAWSWITCH=1]="WITHDRAWSWITCH"}(ke||(ke={}));var De=function(){var e=(0,u.vR)(),r=e.type,t=e.close,n=e.args,f=e.mainTxState,v=(0,s.useState)(!0),x=v[0],y=v[1],g=(0,s.useState)(ke.WITHDRAW),b=g[0],A=g[1],w=(0,l.f)().currentMarketData,T=(0,c.HT)().reserves,S=(0,d.hN)(T),O=p.cr.withdrawAndSwitch(w)&&n.underlyingAsset!==(null===S||void 0===S?void 0:S.underlyingAsset);return(0,ne.jsx)(m.P,{open:r===u.w8.Withdraw,setOpen:function(){A(ke.WITHDRAW),t()},children:(0,ne.jsx)(h.A,{title:(0,ne.jsx)(o.cC,{id:"Withdraw"}),underlyingAsset:n.underlyingAsset,keepWrappedSymbol:!x,requiredPermission:a.g.DEPOSITOR,children:function(e){return(0,ne.jsx)(i.X,{children:function(r){return(0,ne.jsxs)(ne.Fragment,{children:[O&&!f.txHash&&(0,ne.jsx)(Ee,{withdrawType:b,setWithdrawType:A}),b===ke.WITHDRAW&&(0,ne.jsx)(je,We(We({},e),{},{unwrap:x,setUnwrap:y,user:r})),b===ke.WITHDRAWSWITCH&&(0,ne.jsx)(ne.Fragment,{children:(0,ne.jsx)(Te,We(We({},e),{},{user:r}))})]})}})}})})}},30313:function(e,r,t){t.d(r,{k:function(){return u}});var n=t(50029),o=t(87794),a=t.n(o),s=t(1279),i=t(67294),c=t(74119),u=function(e){var r=e.chainId,t=e.max,o=e.maxSlippage,u=e.swapIn,l=e.swapOut,d=e.userAddress,p=e.skip,m=(0,i.useState)("0"),h=m[0],f=m[1],v=(0,i.useState)("0"),x=v[0],y=v[1],g=(0,i.useState)("0"),b=g[0],A=g[1],w=(0,i.useState)("0"),T=w[0],S=w[1],O=(0,i.useState)(),k=O[0],j=O[1],C=(0,i.useState)(!1),I=C[0],E=C[1],R=(0,i.useState)(""),W=R[0],D=R[1],P=(0,i.useMemo)((function(){return{underlyingAsset:u.underlyingAsset,decimals:u.decimals,supplyAPY:u.supplyAPY,amount:u.amount,variableBorrowAPY:u.variableBorrowAPY}}),[u.amount,u.decimals,u.supplyAPY,u.underlyingAsset,u.variableBorrowAPY]),_=(0,i.useMemo)((function(){return{underlyingAsset:l.underlyingAsset,decimals:l.decimals,supplyAPY:l.supplyAPY,amount:l.amount,variableBorrowAPY:l.variableBorrowAPY}}),[l.amount,l.decimals,l.supplyAPY,l.underlyingAsset,l.variableBorrowAPY]),M=(0,i.useCallback)((function(){return(0,c.F8)(P,_,r,d,t)}),[r,P,_,d,t]);return(0,i.useEffect)((function(){if(!p){var e=function(){var e=(0,n.Z)(a().mark((function e(){var r,t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(P.underlyingAsset&&_.underlyingAsset&&P.amount&&"0"!==P.amount&&!isNaN(+P.amount)){e.next=7;break}return f("0"),A("0"),S("0"),y("0"),j(void 0),e.abrupt("return");case 7:return E(!0),e.prev=8,e.next=11,M();case 11:r=e.sent,D(""),j(r),f((0,s.Fv)(r.srcAmount,r.srcDecimals)),y(r.srcUSD),A((0,s.Fv)(r.destAmount,r.destDecimals)),S(r.destUSD),e.next=25;break;case 20:e.prev=20,e.t0=e.catch(8),console.error(e.t0),t=(0,c.aE)(e.t0.message),D(t);case 25:return e.prev=25,E(!1),e.finish(25);case 28:case"end":return e.stop()}}),e,null,[[8,20,25,28]])})));return function(){return e.apply(this,arguments)}}(),r=setTimeout((function(){e()}),400);return function(){clearTimeout(r)}}}),[W,p,P.underlyingAsset,_.underlyingAsset,M,o,P.amount,d,t]),{outputAmount:b,outputAmountUSD:T,inputAmount:h,inputAmountUSD:x,loading:I,error:W,buildTxFn:function(){var e=(0,n.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k){e.next=2;break}throw new Error("Route required to build transaction");case 2:return e.abrupt("return",(0,c.xS)(k,u,l,r,d,o));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}}},39051:function(e,r,t){t.d(r,{E:function(){return i},v:function(){return c}});var n=t(36492),o=t(2593),a=t(56371),s=t(98386),i=function(e,r,t){var i=(0,s.z)().tokenWrapperService;return(0,n.a)({queryFn:function(){return""===e||"0"===e?Promise.resolve(o.O$.from(0)):i.getTokenInForTokenOut((0,a.parseUnits)(e,r).toString(),t)},queryKey:["tokenInForTokenOut",t,e],select:function(e){return(0,a.formatUnits)(e.toString(),r)}})},c=function(e,r,t){var i=(0,s.z)().tokenWrapperService;return(0,n.a)({queryFn:function(){return""===e||"0"===e?Promise.resolve(o.O$.from(0)):i.getTokenOutForTokenIn((0,a.parseUnits)(e,r).toString(),t)},queryKey:["tokenOutForTokenIn",t,e],select:function(e){return(0,a.formatUnits)(e.toString(),r)}})}},28744:function(e,r,t){t.d(r,{M:function(){return g}});var n=t(59499),o=t(50029),a=t(17674),s=t(87794),i=t.n(s),c=t(75331),u=t(80854),l=t(21046),d=t(56371),p=t(89291),m=t(77537),h=t(50597),f=t(39771),v=t(8195);function x(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function y(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?x(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):x(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var g=function(e){var r=e.usePermit,t=e.approvedAmount,n=e.requiresApproval,s=e.assetAddress,x=e.symbol,g=e.decimals,b=e.signatureAmount,A=e.onApprovalTxConfirmed,w=e.onSignTxCompleted,T=(0,h.Y)((function(e){return[e.generateApproval,e.generateSignatureRequest,e.estimateGasLimit,e.addTransaction]})),S=(0,a.Z)(T,4),O=S[0],k=S[1],j=S[2],C=S[3],I=(0,m.Z)(),E=I.signTxData,R=I.sendTx,W=(0,v.vR)(),D=W.approvalTxState,P=W.setApprovalTxState,_=W.setTxError,M=function(){var e=(0,o.Z)(i().mark((function e(){var o,a,m,h,v,T;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!n||!t){e.next=30;break}if(!r){e.next=16;break}return P(y(y({},D),{},{loading:!0})),o=Math.floor(Date.now()/1e3+3600).toString(),e.next=7,k(y(y({},t),{},{deadline:o,amount:"-1"===b?l.Bz.toString():(0,d.parseUnits)(b,g).toString()}));case 7:return a=e.sent,e.next=10,E(a);case 10:m=e.sent,w&&w({signature:m,deadline:o,amount:b}),_(void 0),P({txHash:p.Z,loading:!1,success:!0}),e.next=30;break;case 16:return h=O(t),P(y(y({},D),{},{loading:!0})),e.next=20,j(h);case 20:return h=e.sent,e.next=23,R(h);case 23:return v=e.sent,e.next=26,v.wait(1);case 26:P({txHash:v.hash,loading:!1,success:!0}),_(void 0),C(v.hash,{action:c.UQ.approval,txState:"success",asset:s,amount:u.ke,assetName:x}),A&&A();case 30:e.next=37;break;case 32:e.prev=32,e.t0=e.catch(0),T=(0,f.WG)(e.t0,f.aD.GAS_ESTIMATION,!1),_(T),P({txHash:void 0,loading:!1});case 37:case"end":return e.stop()}}),e,null,[[0,32]])})));return function(){return e.apply(this,arguments)}}();return{approval:M}}},93591:function(e,r,t){t.d(r,{i:function(){return i},y:function(){return c}});var n=t(36492),o=t(50597),a=t(31001),s=t(98386),i=function(e){var r=e.marketData,t=e.token,i=e.spender,c=(0,s.z)().approvedAmountService,u=(0,o.Y)((function(e){return e.account}));return(0,n.a)({queryFn:function(){return c.getApprovedAmount(r,u,t,i)},queryKey:a.B.approvedAmount(u,t,i,r)})},c=function(e,r){var t=(0,s.z)().approvedAmountService,i=(0,o.Y)((function(e){return e.account}));return(0,n.a)({queryFn:function(){return t.getPoolApprovedAmount(e,i,r)},queryKey:a.B.poolApprovedAmount(i,r,e)})}},71691:function(e,r,t){t.d(r,{P:function(){return d}});var n=t(59499),o=t(1279),a=t(3439),s=t(50597),i=t(27887),c=t(87385),u=t(73965),l=(0,n.Z)({},i.e.proto_mainnet_v3,[{tokenIn:a.ou.DAI.UNDERLYING.toLowerCase(),tokenOut:a.ou.sDAI.UNDERLYING.toLowerCase(),tokenWrapperContractAddress:a.zq}]),d=function(){var e,r=(0,u.HT)(),t=r.marketReferencePriceInUsd,n=r.marketReferenceCurrencyDecimals,a=r.reserves,i=(0,s.Y)((function(e){return e.currentMarket}));if(!a||0===a.length)return[];return(null!==(e=l[i])&&void 0!==e?e:[]).map((function(e){var r=a.find((function(r){return r.underlyingAsset===e.tokenIn})),s=a.find((function(r){return r.underlyingAsset===e.tokenOut}));if(!r||!s)throw new Error("wrapped token reserves not found");var i=(0,o.Fv)(r.priceInMarketReferenceCurrency,n),u=(0,o.Fv)(s.priceInMarketReferenceCurrency,n);return{tokenIn:{symbol:r.symbol,underlyingAsset:r.underlyingAsset,decimals:r.decimals,priceInUSD:(0,c.N4)(1,i,t).toString(),formattedPriceInMarketReferenceCurrency:i},tokenOut:{symbol:s.symbol,underlyingAsset:s.underlyingAsset,decimals:s.decimals,priceInUSD:(0,c.N4)(1,u,t).toString(),formattedPriceInMarketReferenceCurrency:u},tokenWrapperAddress:e.tokenWrapperContractAddress}}))}},68448:function(e,r,t){t.d(r,{_S:function(){return s},bU:function(){return i},DX:function(){return c},$m:function(){return u}});var n=t(20854),o=t(1279),a=t(70794);function s(e){var r,t=e.fromAmount,a=e.fromAssetData,s=e.fromAssetUserData,i=e.toAmountAfterSlippage,c=e.toAssetData,u=e.user,l=u.isInEmode&&u.userEmodeCategoryId===a.eModeCategoryId?a.formattedEModeLiquidationThreshold:a.formattedReserveLiquidationThreshold,d="0";s.usageAsCollateralEnabledOnUser&&"0"!==a.reserveLiquidationThreshold&&(d=(0,n.L1)({collateralBalanceMarketReferenceCurrency:(0,o.hE)(t).multipliedBy(a.formattedPriceInMarketReferenceCurrency),borrowBalanceMarketReferenceCurrency:u.totalBorrowsMarketReferenceCurrency,currentLiquidationThreshold:l}).toString());var p="0";return(!u.isInIsolationMode&&!c.isIsolated||u.isInIsolationMode&&(null===(r=u.isolatedReserve)||void 0===r?void 0:r.underlyingAsset)===c.underlyingAsset)&&(p=(0,n.L1)({collateralBalanceMarketReferenceCurrency:(0,o.hE)(i).multipliedBy(c.formattedPriceInMarketReferenceCurrency),borrowBalanceMarketReferenceCurrency:u.totalBorrowsMarketReferenceCurrency,currentLiquidationThreshold:u.isInEmode&&u.userEmodeCategoryId===c.eModeCategoryId?c.formattedEModeLiquidationThreshold:c.formattedReserveLiquidationThreshold}).toString()),{hfEffectOfFromAmount:d,hfAfterSwap:"-1"===u.healthFactor?(0,o.hE)("-1"):(0,o.hE)(u.healthFactor).plus(p).minus(d)}}var i=function(e){var r=e.user,t=e.amountToReceiveAfterSwap,s=e.amountToSwap,i=e.fromAssetData,c=e.toAssetData,u=e.repayWithUserReserve,l=e.debt,d=r.isInEmode&&r.userEmodeCategoryId===i.eModeCategoryId?i.formattedEModeLiquidationThreshold:i.formattedReserveLiquidationThreshold,p="0";null!==u&&void 0!==u&&u.usageAsCollateralEnabledOnUser&&i.usageAsCollateralEnabled&&(p=(0,n.L1)({collateralBalanceMarketReferenceCurrency:(0,o.hE)(s).multipliedBy(i.formattedPriceInMarketReferenceCurrency),borrowBalanceMarketReferenceCurrency:r.totalBorrowsMarketReferenceCurrency,currentLiquidationThreshold:d}).toString());var m=(0,o.hE)(a.Z.min(t,l)).multipliedBy(c.priceInUSD).toString(10),h=(0,o.hE)(r.totalBorrowsUSD).minus(m);h=a.Z.max(h,(0,o.hE)("0"));var f=(0,n.L1)({collateralBalanceMarketReferenceCurrency:r.totalCollateralUSD,borrowBalanceMarketReferenceCurrency:h.toString(10),currentLiquidationThreshold:r.currentLiquidationThreshold}),v="0"!==i.reserveLiquidationThreshold&&null!==u&&void 0!==u&&u.usageAsCollateralEnabledOnUser?(0,n.L1)({collateralBalanceMarketReferenceCurrency:(0,o.hE)(s).multipliedBy(i.priceInUSD),borrowBalanceMarketReferenceCurrency:h.toString(10),currentLiquidationThreshold:i.formattedReserveLiquidationThreshold}).toString():"0",x=f.eq(-1)?f:f.minus(v);return{hfEffectOfFromAmount:(0,o.hE)(p),hfAfterSwap:x.isLessThan(0)&&!x.eq(-1)?0:x}},c=function(e){var r=e.user,t=e.userReserve,s=e.poolReserve,i=e.withdrawAmount,c=(0,o.hE)(r.totalCollateralMarketReferenceCurrency),u=r.currentLiquidationThreshold,l=(0,o.hE)(r.healthFactor),d=r.isInEmode&&r.userEmodeCategoryId===s.eModeCategoryId?s.formattedEModeLiquidationThreshold:s.formattedReserveLiquidationThreshold;if(null!==t&&void 0!==t&&t.usageAsCollateralEnabledOnUser&&"0"!==s.reserveLiquidationThreshold){var p=(0,o.hE)(i).multipliedBy(s.formattedPriceInMarketReferenceCurrency);c=c.minus(p),u=(0,o.hE)(r.totalCollateralMarketReferenceCurrency).multipliedBy((0,o.hE)(r.currentLiquidationThreshold)).minus((0,o.hE)(p).multipliedBy(d)).div(c).toFixed(4,a.Z.ROUND_DOWN),l=(0,n.L1)({collateralBalanceMarketReferenceCurrency:c,borrowBalanceMarketReferenceCurrency:r.totalBorrowsMarketReferenceCurrency,currentLiquidationThreshold:u})}return l},u=function(e,r,t){var a,s=e?(0,o.hE)(e.healthFactor):"-1",i=e?(0,o.hE)(e.totalCollateralMarketReferenceCurrency).plus(t):"-1",c=e?(0,o.hE)(e.totalCollateralMarketReferenceCurrency).multipliedBy(e.currentLiquidationThreshold).plus(t.multipliedBy(r.formattedReserveLiquidationThreshold)).dividedBy(i):"-1";return e&&(!e.isInIsolationMode&&!r.isIsolated||e.isInIsolationMode&&(null===(a=e.isolatedReserve)||void 0===a?void 0:a.underlyingAsset)===r.underlyingAsset)&&(s=(0,n.L1)({collateralBalanceMarketReferenceCurrency:i,borrowBalanceMarketReferenceCurrency:(0,o.hE)(e.totalBorrowsMarketReferenceCurrency),currentLiquidationThreshold:c})),s}},10822:function(e,r,t){var n=t(67294);const o=n.forwardRef((function(e,r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:r},e),n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 15l7-7 7 7"}))}));r.Z=o}}]);